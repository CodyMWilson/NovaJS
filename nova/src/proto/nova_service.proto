syntax = "proto3";

import "nova/src/proto/engine_state.proto";
// https://github.com/Dig-Doug/rules_typescript_proto/issues/4
//import "google/protobuf/any.proto";
//import "google/protobuf/wrappers.proto";

message RepeatedString { // next = 2
  repeated string value = 1;
}

message StringSetDelta { // next = 3
  repeated string add = 1;
  repeated string remove = 2;
}

message StringValue {
  // TODO: Replace with google's version
  // when the bug is fixed.
  string value = 1;
}

message ManagementData { // next = 5
  // Sets the client's UUID
  StringValue uuid = 1;
  
  oneof peersUpdate {
	StringSetDelta peersDelta = 2;
	RepeatedString peers = 3;
  }
  oneof adminsUpdate {
	StringSetDelta adminsDelta = 4;
	RepeatedString admins = 5;
  }
}

message SocketMessageToServer { // next = 4
  // TODO: Make this a oneof?
  string destination = 1;
  bool broadcast = 2;
  GameMessage data = 3;
}

message SocketMessageFromServer { // next = 5
  // TODO: Make this a oneof?
  string source = 1;
  bool broadcast = 2;
  GameMessage data = 3;
  ManagementData managementData = 4;
}

message GameMessage { // next = 2
  oneof messageData {
	EngineState engineState = 1;
  }
}